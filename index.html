
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;swift&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="swift">swift</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#requirements" class="toc-h1 toc-link" data-title="Requirements">Requirements</a>
          </li>
          <li>
            <a href="#install" class="toc-h1 toc-link" data-title="Install">Install</a>
          </li>
          <li>
            <a href="#usage" class="toc-h1 toc-link" data-title="Usage">Usage</a>
          </li>
          <li>
            <a href="#api" class="toc-h1 toc-link" data-title="API">API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#spatialcanvas" class="toc-h2 toc-link" data-title="SpatialCanvas">SpatialCanvas</a>
                  </li>
                  <li>
                    <a href="#spatialcanvasdelegate" class="toc-h2 toc-link" data-title="SpatialCanvasDelegate">SpatialCanvasDelegate</a>
                  </li>
                  <li>
                    <a href="#roomscan" class="toc-h2 toc-link" data-title="RoomScan">RoomScan</a>
                  </li>
                  <li>
                    <a href="#masteranchorscan" class="toc-h2 toc-link" data-title="MasterAnchorScan">MasterAnchorScan</a>
                  </li>
                  <li>
                    <a href="#imagesearchvisualizer" class="toc-h2 toc-link" data-title="ImageSearchVisualizer">ImageSearchVisualizer</a>
                  </li>
                  <li>
                    <a href="#spatialcanvasroom" class="toc-h2 toc-link" data-title="SpatialCanvasRoom">SpatialCanvasRoom</a>
                  </li>
                  <li>
                    <a href="#spatialcanvasroomdelegate" class="toc-h2 toc-link" data-title="SpatialCanvasRoomDelegate">SpatialCanvasRoomDelegate</a>
                  </li>
                  <li>
                    <a href="#spatialcanvasroomdescriptor" class="toc-h2 toc-link" data-title="SpatialCanvasRoomDescriptor">SpatialCanvasRoomDescriptor</a>
                  </li>
                  <li>
                    <a href="#spatialcanvasobject" class="toc-h2 toc-link" data-title="SpatialCanvasObject">SpatialCanvasObject</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#example" class="toc-h1 toc-link" data-title="Example">Example</a>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>SpatialCanvas is an iOS SDK meant to enhance your application by providing a persistent augmented reality experience.
This document specifies the main API for developers.</p>
<h1 id='requirements'>Requirements</h1>
<ul>
<li>iOS 11.3+</li>
<li>ARKit 1.5+</li>
</ul>
<h1 id='install'>Install</h1>
<blockquote>
<p>In your Podfile, add the following line to your targets of interest:</p>
</blockquote>
<pre class="highlight ruby tab-ruby"><code><span class="n">pod</span> <span class="s1">'SpatialCanvas'</span><span class="p">,</span> <span class="s1">'~&gt; 0.5'</span>
</code></pre>
<blockquote>
<p>In your application Info.plist, add the following property:</p>
</blockquote>
<pre class="highlight plaintext"><code>&lt;key&gt;NSLocationWhenInUseUsageDescription&lt;/key&gt;
&lt;string&gt;This application will use the location for Augmented Reality persistence.&lt;/string&gt;
</code></pre>
<p>For now, the SDK only supports <a href="https://cocoapods.org/">CocoaPods</a> as its install method.</p>
<h1 id='usage'>Usage</h1>
<p>The SDK lets you create and restore <code>rooms</code> which have persisted objects associated.
In order to accomplish this, it relies on the existence of a rectangled <code>master anchor</code> object that
should not move and be unique within the real-world space (for instance, a frame in the wall).</p>

<p>In order to create a room the following steps are required:</p>

<ol>
<li>Give the room a unique name.</li>
<li>Scan it.</li>
<li>Scan a master anchor object.</li>
</ol>

<p>On the other hand, when restoring you need to:</p>

<ol>
<li>Select the room you want to restore.</li>
<li>Scan the master anchor object of the restored room.</li>
</ol>
<h1 id='api'>API</h1><h2 id='spatialcanvas'>SpatialCanvas</h2>
<p>The main entry point for the SDK. It exposes functions to create and restore rooms and it&#39;s accessed through the <code>SpatialCanvas.shared</code> singleton instance.</p>
<pre class="highlight swift tab-swift"><code><span class="k">weak</span> <span class="k">var</span> <span class="nv">delegate</span><span class="p">:</span> <span class="kt">SpatialCanvasDelegate</span><span class="p">?</span>
</code></pre>
<blockquote>
<p>Delegate of SDK. It extends the ARSessionDelegate protocol.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">initialize</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Initialize the SDK. This should be done when the application launches.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">run</span><span class="p">(</span><span class="nv">sceneView</span><span class="p">:</span> <span class="kt">ARSCNView</span><span class="p">,</span> <span class="n">with</span> <span class="nv">configuration</span><span class="p">:</span> <span class="kt">ARWorldTrackingConfiguration</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Instead of calling <code>sceneView.session.run(configuration)</code> as you would normally do in an ARKit based app, you should call this function.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">pause</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Instead of calling <code>sceneView.session.pause()</code> you should call this function.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">createRoom</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">room</span><span class="p">:</span> <span class="kt">RoomScan</span><span class="p">,</span> <span class="nv">masterAnchor</span><span class="p">:</span> <span class="kt">MasterAnchorScan</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">Completion</span><span class="o">&lt;</span><span class="kt">ResultValue</span><span class="o">&lt;</span><span class="kt">SpatialCanvasRoom</span><span class="o">&gt;&gt;</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Creates a room with the given <code>name</code>, <code>room scan</code> and <code>masterAnchor</code>.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">restoreRoom</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">Completion</span><span class="o">&lt;</span><span class="kt">ResultValue</span><span class="o">&lt;</span><span class="kt">SpatialCanvasRoom</span><span class="o">&gt;&gt;</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Restores a room with the given <code>id</code>.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">getNearRooms</span><span class="p">(</span><span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">Completion</span><span class="o">&lt;</span><span class="kt">ResultValue</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">SpatialCanvasRoomDescriptor</span><span class="p">]</span><span class="o">&gt;&gt;</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Retrieves a list of near rooms based on the current GPS location.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">deleteRoom</span><span class="p">(</span><span class="nv">roomId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="kt">Completion</span><span class="o">&lt;</span><span class="kt">Result</span><span class="o">&gt;</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Deletes a room with the given id.  </p>
</blockquote>
<h2 id='spatialcanvasdelegate'>SpatialCanvasDelegate</h2>
<p>Delegate that extends the <code>ARSessionDelegate</code>. You should set your view controller as the <code>delegate</code>
on the <code>SpatialCanvas.shared.delegate</code> variable.<br>
Instead of conforming to the <code>ARSessionDelegate</code>, you would conform to the <code>SpatialCanvasDelegate</code>.</p>
<pre class="highlight swift tab-swift"><code><span class="kd">extension</span> <span class="kt">ViewController</span><span class="p">:</span> <span class="kt">SpatialCanvasDelegate</span> <span class="p">{</span>

    <span class="c1">// functions from ARSessionDelegate</span>

    <span class="kd">func</span> <span class="nf">spatialCanvas</span><span class="p">(</span><span class="n">_</span> <span class="nv">spatialCanvas</span><span class="p">:</span> <span class="kt">SpatialCanvas</span><span class="p">,</span> <span class="n">didFailWith</span> <span class="nv">error</span><span class="p">:</span> <span class="kt">Error</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// an SDK error has occurred</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre><h2 id='roomscan'>RoomScan</h2>
<p>Lets you scan the room you are creating. An instance of this class is required to call
the <code>SpatialCanvas.shared.createRoom</code> function.</p>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">start</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Starts the scan.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">stop</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Stops the scan. You can still re-start it from its current state.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">finish</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Call this function once you are done with the scan.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">clear</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Resets the current state of the scanner.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="k">var</span> <span class="nv">onNewFrame</span><span class="p">:</span> <span class="p">(([</span><span class="n">float3</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span>
</code></pre>
<blockquote>
<p>Notifies you about new scanned feature points.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="k">var</span> <span class="nv">onProgress</span><span class="p">:</span> <span class="p">((</span><span class="kt">Float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span>
</code></pre>
<blockquote>
<p>Progress indicator in the range [0,1].</p>
</blockquote>
<h2 id='masteranchorscan'>MasterAnchorScan</h2>
<p>Lets you scan the master anchor object of the room. An instance of this class is required to call
the <code>SpatialCanvas.shared.createRoom</code> function.
All described functions for the <code>RoomScan</code> apply for this class as well.</p>
<pre class="highlight swift tab-swift"><code><span class="nf">init</span><span class="p">(</span><span class="nv">visualizer</span><span class="p">:</span> <span class="kt">ImageSearchVisualizer</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Creates an instance with an associated visualizer. The visualizer will be notified about the scanner state.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">scan</span><span class="p">()</span>
</code></pre>
<blockquote>
<p>Attempts to extract the current rectangled detected shape. In case of success, it will be notified to the visualizer.</p>
</blockquote>
<h2 id='imagesearchvisualizer'>ImageSearchVisualizer</h2>
<p>Protocol used to provide feedback about the current master anchor scan state.</p>
<pre class="highlight swift tab-swift"><code><span class="kd">protocol</span> <span class="kt">ImageSearchVisualizer</span> <span class="p">{</span>

  <span class="c1">// on-screen rectangle</span>
  <span class="kd">func</span> <span class="nf">on</span><span class="p">(</span><span class="nv">rectangle</span><span class="p">:</span> <span class="kt">Rectangle2D</span><span class="p">)</span>

  <span class="c1">// real-world metrics</span>
  <span class="kd">func</span> <span class="nf">on</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="kt">Double</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="kt">Double</span><span class="p">)</span>

  <span class="c1">// after a successful masterAnchorScan.scan() call</span>
  <span class="kd">func</span> <span class="nf">on</span><span class="p">(</span><span class="nv">image</span><span class="p">:</span> <span class="kt">ImageWithMetrics</span><span class="p">)</span>

  <span class="kd">func</span> <span class="nf">onReset</span><span class="p">()</span>
  <span class="kd">func</span> <span class="nf">onNoRectangle</span><span class="p">()</span>

<span class="p">}</span>
</code></pre><h2 id='spatialcanvasroom'>SpatialCanvasRoom</h2>
<p>Represents a created or restored room. It lets you add objects and notifies you whenever objects are added, found or updated.</p>
<pre class="highlight swift tab-swift"><code><span class="k">weak</span> <span class="k">var</span> <span class="nv">delegate</span><span class="p">:</span> <span class="kt">SpatialCanvasRoomDelegate</span><span class="p">?</span>
</code></pre>
<blockquote>
<p>Delegate of the room. It will be notified when an object is found, added or updated. Objects are found only when restoring a room.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="k">let</span> <span class="nv">masterAnchor</span><span class="p">:</span> <span class="kt">MasterAnchor</span>
</code></pre>
<blockquote>
<p>Master anchor object. It has an imageUrl property describing the scanned anchor object.</p>
</blockquote>
<pre class="highlight swift tab-swift"><code><span class="kd">func</span> <span class="nf">addObject</span><span class="p">(</span><span class="nv">position</span><span class="p">:</span> <span class="n">float3</span><span class="p">,</span> <span class="nv">eulerAngles</span><span class="p">:</span> <span class="n">float3</span><span class="p">,</span> <span class="nv">completion</span><span class="p">:</span> <span class="kt">Completion</span><span class="o">&lt;</span><span class="kt">Result</span><span class="o">&gt;</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Adds an object to the room in the given position and orientation. The object addition will be notified through the delegate.</p>
</blockquote>
<h2 id='spatialcanvasroomdelegate'>SpatialCanvasRoomDelegate</h2>
<p>Notifies you whenever objects are added, found or updated.</p>
<pre class="highlight swift tab-swift"><code><span class="kd">protocol</span> <span class="kt">SpatialCanvasRoomDelegate</span><span class="p">:</span> <span class="kd">class</span> <span class="p">{</span>

  <span class="c1">// objects were found after restoring a room and scanning the master anchor object</span>
  <span class="kd">func</span> <span class="nf">spatialCanvasRoom</span><span class="p">(</span><span class="n">_</span> <span class="nv">spatialCanvasRoom</span><span class="p">:</span> <span class="kt">SpatialCanvasRoom</span><span class="p">,</span> <span class="n">didFindObjects</span> <span class="nv">objects</span><span class="p">:</span> <span class="p">[</span><span class="kt">SpatialCanvasObject</span><span class="p">])</span>

  <span class="c1">// object was added to the room</span>
  <span class="kd">func</span> <span class="nf">spatialCanvasRoom</span><span class="p">(</span><span class="n">_</span> <span class="nv">spatialCanvasRoom</span><span class="p">:</span> <span class="kt">SpatialCanvasRoom</span><span class="p">,</span> <span class="n">didAddObject</span> <span class="nv">object</span><span class="p">:</span> <span class="kt">SpatialCanvasObject</span><span class="p">)</span>

  <span class="c1">// objects already added or found were updated in the room</span>
  <span class="kd">func</span> <span class="nf">spatialCanvasRoom</span><span class="p">(</span><span class="n">_</span> <span class="nv">spatialCanvasRoom</span><span class="p">:</span> <span class="kt">SpatialCanvasRoom</span><span class="p">,</span> <span class="n">didUpdateObjects</span> <span class="nv">objects</span><span class="p">:</span> <span class="p">[</span><span class="kt">SpatialCanvasObject</span><span class="p">])</span>

<span class="p">}</span>
</code></pre><h2 id='spatialcanvasroomdescriptor'>SpatialCanvasRoomDescriptor</h2>
<p>Room descriptor.</p>
<pre class="highlight swift tab-swift"><code><span class="kd">class</span> <span class="kt">SpatialCanvasRoomDescriptor</span><span class="p">:</span> <span class="kt">NSObject</span> <span class="p">{</span>

    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span>

<span class="p">}</span>
</code></pre><h2 id='spatialcanvasobject'>SpatialCanvasObject</h2>
<p>Represents an object being managed by the SDK.</p>
<pre class="highlight swift tab-swift"><code><span class="kd">class</span> <span class="kt">SpatialCanvasObject</span> <span class="p">{</span>

    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">let</span> <span class="nv">position</span><span class="p">:</span> <span class="n">float3</span>

    <span class="c1">// orientation</span>
    <span class="k">let</span> <span class="nv">eulerAngles</span><span class="p">:</span> <span class="n">float3</span>

<span class="p">}</span>
</code></pre><h1 id='example'>Example</h1>
<p>In order to see an example of usage please visit <a href="https://github.com/spatialcanvas/spatialcanvas-ios">here</a>.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="swift">swift</a>
          </div>
      </div>
    </div>
  </body>
</html>
